<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 0 - Jetson Experimentation UML Diagrams</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        h2 {
            color: #444;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        .diagram-container {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            overflow-x: auto;
        }
        .description {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
        }
        .legend {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }
        code {
            background: #f1f3f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #d63384;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Task 0: Baseline PyTorch Implementation</h1>
        <div class="subtitle">UML Architecture Diagrams - Jetson Experimentation Framework</div>

        <h2>1. Class Diagram - Complete System Architecture</h2>
        <div class="description">
            This diagram shows the complete object-oriented structure with all classes, their attributes, methods, and relationships. The refactored architecture separates concerns into specialized components.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
classDiagram
    class Config {
        +String MODEL_PT
        +int IMG_SIZE
        +int CAMERA_INDEX
        +int DEVICE
        +String DATA_YAML
        +int WARMUP_FRAMES
        +int METRIC_BUFFER_SIZE
        +float FPS_ALPHA
    }
    
    class BaselineInferenceEngine {
        -Config config
        -YOLO model
        -MetricsCollector metrics_collector
        -Visualizer visualizer
        -PerformanceAnalyzer analyzer
        +load_model()
        +print_system_info()
        +run_live_inference(camera_index, display) Dict
        +run_coco_validation() Dict
        +save_metrics(metrics, filename)
        -_print_periodic_stats(stats)
    }
    
    class MetricsCollector {
        -int warmup_frames
        -int buffer_size
        -List~float~ latencies
        -deque latency_buffer
        -deque fps_history
        -float fps_smooth
        -int frame_count
        -float last_time
        +add_measurement(latency_ms, timestamp)
        +is_warming_up() bool
        +get_current_stats() Dict
        +calculate_final_metrics() Dict
    }
    
    class Visualizer {
        -String window_name
        -font FONT_HERSHEY_SIMPLEX
        -Dict colors
        +draw_metrics(frame, stats, warming_up) ndarray
        +show(frame) bool
    }
    
    class PerformanceAnalyzer {
        +analyze(metrics)$ Dict
        -_classify_performance(mean_latency)$ String
        -_assess_stability(metrics)$ String
        -_generate_recommendations(metrics)$ List
    }
    
    class Orchestrator {
        +main()
        +parse_arguments() Args
        +execute_mode(engine, args)
    }
    
    BaselineInferenceEngine --> Config : uses
    BaselineInferenceEngine --> MetricsCollector : contains
    BaselineInferenceEngine --> Visualizer : contains
    BaselineInferenceEngine --> PerformanceAnalyzer : contains
    Orchestrator --> BaselineInferenceEngine : creates
    Orchestrator --> Config : creates
            </div>
        </div>

        <h2>2. Sequence Diagram - Live Inference Flow</h2>
        <div class="description">
            This sequence diagram illustrates the flow of execution during live camera inference, showing how components interact to process frames, collect metrics, and display results.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
sequenceDiagram
    participant User
    participant Orchestrator
    participant Engine as BaselineInferenceEngine
    participant Model as YOLO Model
    participant Metrics as MetricsCollector
    participant Viz as Visualizer
    participant Camera
    
    User->>Orchestrator: python orchestrator.py --mode live
    Orchestrator->>Engine: create(config)
    Orchestrator->>Engine: run_live_inference()
    
    Engine->>Engine: print_system_info()
    Engine->>Model: load_model()
    Engine->>Camera: cv2.VideoCapture(0)
    
    loop Every Frame
        Camera->>Engine: cap.read()
        Note over Engine: Preprocess frame
        
        Engine->>Model: model(frame)
        Model-->>Engine: results
        
        Note over Engine: Calculate latency
        Engine->>Metrics: add_measurement(latency, timestamp)
        
        Metrics->>Metrics: update_statistics()
        Metrics-->>Engine: current_stats
        
        alt Display Enabled
            Engine->>Viz: draw_metrics(frame, stats)
            Viz-->>Engine: annotated_frame
            Engine->>Viz: show(annotated_frame)
            Viz-->>Engine: continue_flag
        end
        
        alt Frame % 100 == 0
            Engine->>Engine: _print_periodic_stats()
        end
    end
    
    Engine->>Metrics: calculate_final_metrics()
    Metrics-->>Engine: final_metrics
    Engine->>Engine: save_metrics()
    Engine-->>Orchestrator: metrics
    Orchestrator-->>User: Results saved
            </div>
        </div>

        <h2>3. Component Diagram - System Architecture</h2>
        <div class="description">
            High-level component view showing the modular structure and dependencies between different parts of the system.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "Presentation Layer"
        UI[Visualizer<br/>Display & Overlay]
        CLI[Orchestrator<br/>CLI Interface]
    end
    
    subgraph "Business Logic Layer"
        ENGINE[BaselineInferenceEngine<br/>Core Logic]
        ANALYZER[PerformanceAnalyzer<br/>Insights Generation]
    end
    
    subgraph "Data Layer"
        METRICS[MetricsCollector<br/>Statistics Management]
        CONFIG[Config<br/>Settings Store]
    end
    
    subgraph "External Components"
        YOLO[YOLO Model<br/>PyTorch]
        CAMERA[Camera<br/>OpenCV]
        COCO[COCO Dataset<br/>Validation]
    end
    
    CLI --> ENGINE
    ENGINE --> UI
    ENGINE --> ANALYZER
    ENGINE --> METRICS
    ENGINE --> CONFIG
    ENGINE --> YOLO
    ENGINE --> CAMERA
    ENGINE --> COCO
    ANALYZER --> METRICS
    UI --> METRICS
    
    style ENGINE fill:#667eea,stroke:#fff,color:#fff
    style METRICS fill:#764ba2,stroke:#fff,color:#fff
    style CONFIG fill:#ffc107,stroke:#fff,color:#000
            </div>
        </div>

        <h2>4. State Diagram - Inference Engine States</h2>
        <div class="description">
            Shows the different states of the inference engine during execution and the transitions between them.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
stateDiagram-v2
    [*] --> Initialization
    
    Initialization --> SystemCheck: load_model()
    SystemCheck --> WarmingUp: Start inference
    
    WarmingUp --> Processing: After 20 frames
    WarmingUp --> WarmingUp: Frame < 20
    
    Processing --> Processing: Process frame
    Processing --> PeriodicReport: Every 100 frames
    PeriodicReport --> Processing: Continue
    
    Processing --> Terminating: ESC pressed
    Processing --> Terminating: Error occurred
    
    Terminating --> Cleanup: Release resources
    Cleanup --> MetricsCalculation: Calculate final stats
    MetricsCalculation --> SaveResults: Save to file
    SaveResults --> [*]
    
    state Processing {
        [*] --> CaptureFrame
        CaptureFrame --> Preprocess
        Preprocess --> Inference
        Inference --> PostProcess
        PostProcess --> UpdateMetrics
        UpdateMetrics --> Visualization
        Visualization --> [*]
    }
            </div>
        </div>

        <h2>5. Activity Diagram - Frame Processing Pipeline</h2>
        <div class="description">
            Detailed view of the frame processing pipeline, showing the flow from frame capture to display with decision points.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
flowchart TD
    Start([Start Frame Processing]) --> Capture[Capture Frame from Camera]
    Capture --> CheckValid{Frame Valid?}
    CheckValid -->|No| End([End])
    CheckValid -->|Yes| Resize[Resize to 640x640]
    
    Resize --> StartTimer[Start Timer]
    StartTimer --> RunInference[Run YOLO Inference]
    RunInference --> StopTimer[Stop Timer]
    StopTimer --> CalcLatency[Calculate Latency]
    
    CalcLatency --> CheckWarmup{In Warmup Period?}
    CheckWarmup -->|Yes| SkipMetrics[Skip Metrics Recording]
    CheckWarmup -->|No| RecordMetrics[Record Metrics]
    
    SkipMetrics --> CheckDisplay{Display Enabled?}
    RecordMetrics --> UpdateStats[Update Statistics]
    UpdateStats --> CheckDisplay
    
    CheckDisplay -->|No| CheckContinue{Continue?}
    CheckDisplay -->|Yes| DrawOverlay[Draw Metrics Overlay]
    DrawOverlay --> ShowFrame[Display Frame]
    ShowFrame --> CheckContinue
    
    CheckContinue -->|ESC Pressed| End
    CheckContinue -->|Continue| CheckPeriodic{Frame % 100 == 0?}
    CheckPeriodic -->|Yes| PrintStats[Print Console Stats]
    CheckPeriodic -->|No| NextFrame[Next Frame]
    PrintStats --> NextFrame
    NextFrame --> Capture
    
    style Start fill:#90EE90
    style End fill:#FFB6C1
    style RunInference fill:#667eea,stroke:#fff,color:#fff
            </div>
        </div>

        <h2>6. Object Relationship Diagram</h2>
        <div class="description">
            Shows the runtime object relationships and data flow between components during execution.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
graph LR
    subgraph "Runtime Objects"
        O1[orchestrator:Orchestrator]
        O2[config:Config]
        O3[engine:BaselineInferenceEngine]
        O4[model:YOLO]
        O5[metrics:MetricsCollector]
        O6[viz:Visualizer]
        O7[analyzer:PerformanceAnalyzer]
    end
    
    subgraph "Data Structures"
        D1[(latencies:List)]
        D2[(fps_history:deque)]
        D3[(latency_buffer:deque)]
        D4[(final_metrics:Dict)]
    end
    
    O1 -->|creates| O2
    O1 -->|creates| O3
    O3 -->|owns| O4
    O3 -->|owns| O5
    O3 -->|owns| O6
    O3 -->|owns| O7
    
    O5 -->|maintains| D1
    O5 -->|maintains| D2
    O5 -->|maintains| D3
    O5 -->|produces| D4
    
    O3 -->|uses| O2
    O6 -->|reads| D3
    O7 -->|analyzes| D4
            </div>
        </div>

        <div class="legend">
            <strong>📝 Legend:</strong><br>
            • <code>+</code> Public method/attribute<br>
            • <code>-</code> Private method/attribute<br>
            • <code>$</code> Static method<br>
            • <code>--></code> Association/Dependency<br>
            • <code>contains</code> Composition relationship<br>
            • <code>uses</code> Usage relationship
        </div>

        <h2>7. Deployment Diagram - Jetson Platform</h2>
        <div class="description">
            Physical deployment view showing how the components are deployed on the Jetson hardware platform.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
graph TB
    subgraph "NVIDIA Jetson Platform"
        subgraph "GPU (CUDA Cores)"
            CUDA[CUDA Runtime]
            CUDNN[cuDNN Library]
            TENSOR[Tensor Cores]
        end
        
        subgraph "CPU (ARM Cortex)"
            PYTHON[Python 3.8+]
            OPENCV[OpenCV 4.x]
            NUMPY[NumPy]
        end
        
        subgraph "Memory"
            RAM[Unified Memory<br/>CPU/GPU Shared]
        end
        
        subgraph "Storage"
            MODEL_FILE[yolov8s.pt<br/>~22MB]
            METRICS_FILE[metrics.json]
            CODE[Python Scripts]
        end
        
        subgraph "I/O Devices"
            CAM[USB/CSI Camera]
            DISPLAY[HDMI Display]
        end
    end
    
    PYTHON --> CODE
    CODE --> MODEL_FILE
    PYTHON --> OPENCV
    OPENCV --> CAM
    OPENCV --> DISPLAY
    PYTHON --> CUDA
    CUDA --> TENSOR
    CUDA --> CUDNN
    RAM --> CUDA
    RAM --> PYTHON
    CODE --> METRICS_FILE
    
    style CUDA fill:#76b900,stroke:#fff,color:#fff
    style TENSOR fill:#76b900,stroke:#fff,color:#fff
            </div>
        </div>

        <h2>8. Use Case Diagram</h2>
        <div class="description">
            Shows the different use cases supported by the system and the actors involved.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
graph TD
    subgraph "Task 0 System"
        UC1((Run Live Inference))
        UC2((Run COCO Validation))
        UC3((Display Metrics))
        UC4((Save Results))
        UC5((Analyze Performance))
        UC6((Generate Recommendations))
    end
    
    User[👤 User]
    Camera[📷 Camera]
    Dataset[📊 COCO Dataset]
    
    User --> UC1
    User --> UC2
    Camera --> UC1
    Dataset --> UC2
    UC1 --> UC3
    UC1 --> UC4
    UC2 --> UC4
    UC4 --> UC5
    UC5 --> UC6
    
    style UC1 fill:#667eea,stroke:#fff,color:#fff
    style UC2 fill:#764ba2,stroke:#fff,color:#fff
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#5a67d8',
                lineColor: '#5a67d8',
                secondaryColor: '#764ba2',
                tertiaryColor: '#f7fafc'
            }
        });
    </script>
</body>
</html>